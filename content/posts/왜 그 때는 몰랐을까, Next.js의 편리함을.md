---
title: ì™œ ê·¸ ë•ŒëŠ” ëª°ëì„ê¹Œ, Next.jsì˜ í¸ë¦¬í•¨ì„
createdTime: 2023-03-25
tags:
    - projects
    - React
    - Next.js
    - frontend
description: Next.jsë¥¼ ì´ë²ˆ í”„ë¡œì íŠ¸ì— ë³¸ê²©ì ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ì„œ ì—¬ëŸ¬ í¸ë¦¬í•œ ê¸°ëŠ¥ë“¤ì„ ì‚¬ìš©í•˜ë©´ì„œ ëŠë‚€ì ê³¼ ê¸°ì¡´ Reactì—ì„œëŠ” ì–´ë–»ê²Œ ê°™ì€ ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆì—ˆëŠ”ì§€ ë¹„êµí•˜ëŠ” ì‹œê°„ì„ ê°€ì¡Œë‹¤.
---

# ê°œìš”

ì´ì „ì—ëŠ” ì£¼ë¡œ `create-react-app`ì´ë‚˜ ìì²´ì ìœ¼ë¡œ ë§Œë“¤ì–´ ë‘ì—ˆë˜ [React-typescript-boilerplate](https://github.com/mrbartrns/react-typescript-boilerplate) ë¥¼ ì´ìš©í•˜ì—¬ ë¦¬ì•¡íŠ¸ í™˜ê²½ì„ ì§ì ‘ êµ¬ì„±í•˜ì—¬ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í–ˆë‹¤. ì˜ ë§Œë“¤ì–´ì§„ ë‹¤ë¥¸ í”„ë ˆì„ì›Œí¬(Next, gatsby)ë“¤ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë§ì´ë‹¤.

ì‚¬ìš©í•˜ì§€ ì•Šì€ ì´ìœ ëŠ” ì—¬ëŸ¬ ì´ìœ ë“¤ì´ ì¡´ì¬í•˜ì§€ë§Œ, ì´ì „ íŒ€ í”„ë¡œì íŠ¸ë¥¼ Nextjsì— ëŒ€í•´ì„œ ì œëŒ€ë¡œ ì•Œì§€ ëª»í•˜ê³ , ë‹¨ìˆœíˆ ê²½í—˜ì‚¼ì•„ ì‚¬ìš©í•´ ë³´ê³ ì‹¶ë‹¤ëŠ” ì´ìœ ë¡œ í•´ë‹¹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í–ˆëŠ”ë°, ë•ë¶„ì— íŒ€ì›ê³¼ í•¨ê»˜ ê°œë°œí•˜ë©´ì„œ ë§ì€ ì˜¤ë¥˜ë¥¼ ê²½í—˜í•˜ì—¬ ë‹¤ì‹œ ê±´ë“œë¦¬ëŠ” ê²ƒì´ ë¬´ì„œì› ë˜ ì´ìœ ê°€ ì»¸ë‹¤.

ì˜ˆë¥¼ ë“¤ë©´, ê¸°ì¡´ì— reactì—ì„œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ë°ì´í„° ì €ì¥ì´ í•„ìš”í•  ë•Œ, localStorageë¥¼ ì£¼ë¡œ ì‚¬ìš©í–ˆì—ˆê³  ì–´ë””ì—ì„œë‚˜ ì ‘ê·¼ì´ ê°€ëŠ¥í–ˆë‹¤.

```tsx
const ReactComponent = () => {
  const [value, setValue] = useState(() => {
    return window.localStorage.getItem('key') || ''
  }) // ê°€ëŠ¥

  return (
    <h1>{value}</h1>
  )
}
```

ê·¸ëŸ¬ë‚˜ Nextjsì˜ ê²½ìš° ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì´ê¸° ë•Œë¬¸ì—, ë Œë” ë‹¨ê³„ì—ì„œ ìŠ¤í† ë¦¬ì§€ì— ì ‘ê·¼í•˜ì—¬ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë©°, ì˜¤ì§ `useEffect` hookì„ í†µí•´ localStorage ê°’ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

```tsx
const NextComponent = () => {
  const [value, setValue] = useState('');
  
  // ì»´í¬ë„ŒíŠ¸ê°€ ì„œë²„ì‚¬ì´ë“œì—ì„œ ë Œë”ë§ëœ ë’¤, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë™ì‘í•˜ëŠ” useEffectì—ì„œ localStorage ì ‘ê·¼ ê°€ëŠ¥
  // ì„œë²„ì‚¬ì´ë“œì—ì„œ window ê°ì²´ëŠ” undefinedì´ë‹¤.
  useEffect(() => {
    setValue(() => window.localStorage.getItem('key') || '')
  }, [])
  
  // mount í›„ useEffect hook ì‹¤í–‰ìœ¼ë¡œ ì¸í•´ ì°°ë‚˜ì˜ ì‹œê°„ì— ë°ì´í„°ê°€ ë³€í•˜ëŠ” í˜„ìƒ ë°œìƒ
  return (
    {value && <h1>{value}</h1>}
  )
}
```

ì´ëŸ° ë™ì‘ ë°©ì‹ ìƒì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ì§€ ëª»í•˜ê³  Reactì—ì„œ ì‚¬ìš©í•˜ë˜ ë°©ì‹ ê·¸ëŒ€ë¡œ ê°œë°œì„ ì§„í–‰í–ˆì—ˆê¸° ë•Œë¬¸ì— íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ì— ë§ì€ ì‹œê°„ì„ íˆ¬ìí•  ìˆ˜ë°–ì— ì—†ì—ˆë‹¤.

# Reactì™€ëŠ” ì•½ê°„ ë‹¤ë¥¸ Next.jsì˜ ë™ì‘ ë°©ì‹

> í‹€ë¦° ë‚´ìš©ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

NextjsëŠ” React ê¸°ë°˜ì´ì§€ë§Œ, ì¼ë°˜ Reactê°€ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œë§Œ ë™ì‘í•˜ëŠ” ê²ƒê³¼ ë‹¬ë¦¬ ì„œë²„, í´ë¼ì´ì–¸íŠ¸ ëª¨ë‘ ë‹¤ë£° ìˆ˜ ìˆëŠ” í’€ìŠ¤íƒ í”„ë ˆì„ì›Œí¬ì´ë‹¤. ì´ë¥¼ ë³´ë‹¤ ê¹Šê²Œ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” ìš°ì„  í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ê³¼ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì— ëŒ€í•œ ì´í•´ê°€ í•„ìš”í•˜ë‹¤.

## í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§(CSR)

<aside> ğŸ“Œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ì€, ë¸Œë¼ìš°ì €ê°€ ë Œë”ë§ì˜ ì£¼ì²´ë¡œì„œ ë Œë”ë§ ê³¼ì •ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒì„ ëœ»í•œë‹¤.

</aside>

![í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ ë™ì‘ ê³¼ì •](https://d2.naver.com/content/images/2020/06/csr.png)

í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ ë™ì‘ ê³¼ì •

í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ìš”ì²­í•˜ë©´, ì„œë²„ëŠ” ì‘ë‹µí•˜ì—¬ í˜ì´ì§€ ë Œë”ë§ì— í•„ìš”í•œ html í…œí”Œë¦¿ê³¼ í˜ì´ì§€ ë Œë”ë§ì— í•„ìš”í•œ ìë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ í´ë¼ì´ì–¸íŠ¸ì— ì „ì†¡í•œë‹¤. ê·¸ë¦¬ê³  ë¸Œë¼ìš°ì €ëŠ” ì„œë²„ë¡œë¶€í„° ë°›ì€ ë¹ˆ html í…œí”Œë¦¿ê³¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ DOMì„ ë Œë”ë§í•œë‹¤.

í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ì€ ëª‡ ê°€ì§€ íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆë‹¤.

1.  ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ë°©ì‹ì´ í˜ì´ì§€ ì´ë™ì— ë”°ë¼ ìƒˆë¡œìš´ html í…œí”Œë¦¿ì„ ìš”ì²­í•˜ê¸° ë•Œë¬¸ì— ìƒˆë¡œê³ ì¹¨(ê¹œë¹¡ í˜„ìƒ)ì´ ë°œìƒí•˜ëŠ” ê²ƒê³¼ ë‹¬ë¦¬, í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì´ìš©í•˜ì—¬ í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ê·¸ë ¤ë‚¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê¹œë¹¡ì„ í˜„ìƒ ì—†ì´ í˜ì´ì§€ë¥¼ ì´ë™ì‹œí‚¬ ìˆ˜ ìˆë‹¤(ì‹¤ì œë¡œ history apië¥¼ ì´ìš©í•˜ì—¬ urlì„ ë³€ê²½í•˜ê³  historyì— ì €ì¥í•˜ì§€ë§Œ, ì‹¤ì œë¡œ í˜ì´ì§€ë¥¼ ì„œë²„ì— ìš”ì²­í•˜ì§€ ì•Šê³  urlì— ë§ê²Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤).
2.  ëª¨ë“  í˜ì´ì§€ ë Œë”ë§ì— í•„ìš”í•œ(ë”°ë¡œ ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…ì„ ì§„í–‰í•˜ì§€ ì•Šì•˜ë‹¤ë©´) ìë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì´ˆê¸° ë¡œë”©ì‹œ ë°›ì•„ ì‹¤í–‰í•˜ë¯€ë¡œ FCP(First Contentful Paint)ëŠ” ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ë³´ë‹¤ ëŠë¦¬ë‹¤. ë‹¨, í˜ì´ì§€ê°€ ì™„ì „íˆ ë¡œë”©ë˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì€ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ë³´ë‹¤ ë¹ ë¥´ë‹¤.

## ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§

<aside> ğŸ“Œ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì€ ë Œë”ë§ ì£¼ì²´ê°€ ì„œë²„ê°€ ë˜ì–´, ì„œë²„ì—ì„œ í…œí”Œë¦¿ì„ ë Œë”ë§í•œ ë’¤ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•˜ëŠ” ë°©ì‹ì´ë‹¤.

</aside>

![ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ë™ì‘ ê³¼ì •](https://d2.naver.com/content/images/2020/06/ssr.png)

ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ë™ì‘ ê³¼ì •

í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ìš”ì²­í•˜ë©´, ì„œë²„ëŠ” ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ html í…œí”Œë¦¿ì„ ê·¸ë¦° ë’¤ í´ë¼ì´ì–¸íŠ¸ì— ì „ì†¡í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ëŠ” ì±„ì›Œì§„ html í…œí”Œë¦¿ê³¼ ìƒí˜¸ì‘ìš©ì„ ìœ„í•œ ìë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì‹¤í–‰í•œë‹¤.

ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì€ ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì´ ìˆë‹¤.

1.  ì„œë²„ê°€ ë Œë”ë§ì„ ë‹´ë‹¹í•˜ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ê³¼ ë‹¬ë¦¬ html í…œí”Œë¦¿ì— ì •ë³´ê°€ ì¡´ì¬í•˜ëŠ” ìƒíƒœì´ë¯€ë¡œ, ì‚¬ìš©ìëŠ” í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ë³´ë‹¤ ë¹ ë¥´ê²Œ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
2.  ë‹¤ë§Œ ìƒí˜¸ì‘ìš©ì´ ì¤€ë¹„ë˜ê¸° ê¹Œì§€ ê±¸ë¦¬ëŠ” ì‹œê°„(ì™„ì „íˆ ë¡œë”©ë˜ëŠ” ì‹œê°„)ì€ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ ë°©ì‹ë³´ë‹¤ ëŠë¦¬ë‹¤.

í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ ë°©ì‹ê³¼ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ë°©ì‹ì€ ì´ì™€ ê°™ì´ ì¥ì ê³¼ ë‹¨ì ì´ ëª…í™•í•˜ê²Œ ë°˜ëŒ€ë¨ì„ ì•Œ ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ë‘ ë Œë”ë§ ë°©ì‹ì˜ ì¥ì ì„ ì·¨í•˜ê¸° ìœ„í•œ ë°©ë²•ì„ ì°¾ê¸° ì‹œì‘í–ˆê³ , ê·¸ ì¤‘ í•˜ë‚˜ê°€ Next.jsì˜ ë°©ì‹ì´ë‹¤.

## Next.jsì˜ ë Œë”ë§ ë°©ì‹

### ì´ˆê¸° ë¡œë”© ì‹œ(SSR)

1.  Next.jsëŠ” Reactì™€ ë‹¬ë¦¬ ì„œë²„ì—ì„œ ì›¹ í˜ì´ì§€ë¥¼ í”„ë¦¬ë Œë”ë§í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡í•œë‹¤.
2.  í´ë¼ì´ì–¸íŠ¸ëŠ” html í…œí”Œë¦¿ì„ ë°›ì•˜ì§€ë§Œ, ì›¹ í™”ë©´ë§Œ êµ¬ì„±ë˜ì–´ ìˆì„ ë¿, ì–´ë– í•œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ìš”ì†Œë“¤ë„ ì—†ëŠ” ìƒíƒœì´ë‹¤. ì´ëŠ” ë‹¨ìˆœ í´ë¦­ê³¼ ê°™ì€ ì´ë²¤íŠ¸ë“¤ë„ DOMì— ì—°ê²°ë˜ì–´ ìˆì§€ ì•Šì€ ìƒíƒœì„ì„ ëœ»í•œë‹¤.
3.  í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ hydrationì„ ì§„í–‰í•œë‹¤. hydrateëŠ” `ReactDOMServer`ë¥¼ ì´ìš©í•˜ì—¬ ë Œë”ë§ ëœ htmlì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì—°ê²°ì‹œì¼œì£¼ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.

ì—¬ê¸°ê¹Œì§€ê°€ Next.jsì˜ í”„ë¦¬ë Œë”ë§ ë‹¨ê³„ì´ë‹¤. í”„ë¦¬ë Œë”ë§ì€ SSG(Static Site Generation, í”„ë¦¬ ë Œë”ë§ì„ ì •ì ìœ¼ë¡œ ì§„í–‰, ë¹Œë“œ ë‹¨ê³„ì—ì„œ í˜ì´ì§€ ìƒì„±) ë˜ëŠ” SSR(Server Side Rendering, í”„ë¦¬ ë Œë”ë§ì„ ë™ì ìœ¼ë¡œ ì§„í–‰, ì„œë²„ì—ì„œ ë°ì´í„° í˜ì¹­) ë‘ ì¢…ë¥˜ê°€ ìˆì§€ë§Œ, ì´ ê¸€ì—ì„œëŠ” ì—¬ê¸°ê¹Œì§€ë§Œ ì•Œì•„ë³´ëŠ” ê±¸ë¡œ..

### í˜ì´ì§€ ì´ë™ ì‹œ(CSR)

í˜ì´ì§€ ì´ë™ ì‹œ, Next.jsëŠ” í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ ë°©ì‹ì„ í†µí•´ ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ë Œë”ë§ì„ ì§„í–‰í•œë‹¤. (`next/link`ì„ ì´ìš©í•˜ì—¬ í˜ì´ì§€ ì´ë™ ì‹œ)

> ì¦‰, Next.jsëŠ” ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì˜ ì¥ì ê³¼ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ì˜ ì¥ì ì„ ì–´ëŠ ì •ë„ ì ˆì¶©í•œë‹¤.

ê·¸ë˜ì„œ Reactì™€ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ `window.localStorage`ì— ì ‘ê·¼í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ” ì´ìœ ëŠ”, ì„œë²„ì—ì„œ í”„ë¦¬ë Œë”ë§ì„ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

# í¸í–ˆë˜ ì ë“¤

ì´ë²ˆ ë¸”ë¡œê·¸ë¥¼ Next.jsë¥¼ ì´ìš©í•˜ì—¬ ë§Œë“¤ë©´ì„œ, ê¸°ì¡´ì— Reactë§Œì„ ì‚¬ìš©í–ˆì„ ë•Œ ëŠë¼ì§€ ëª»í–ˆë˜ ì ë“¤ì„ ê°„ë‹¨í•˜ê²Œ ê¸°ë¡í•´ ë³´ê³ ì í•œë‹¤. ì‚¬ì‹¤ ì´ ë¶€ë¶„ì´ ë©”ì¸ì¸ë° ì„œë¡ ì´ ë„ˆë¬´ ê¸¸ì–´ì¡Œë‹¤. SEO ê°™ì´ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§, ì •ì  í”„ë ˆì„ì›Œí¬ê°€ ì§€ì›í•˜ëŠ” íŠ¹ì„± ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” ì¼ë‹¨ ì œì™¸í•˜ê³ , ì‹¤ì œ ì‚¬ìš©í•˜ë©´ì„œ ëŠê¼ˆë˜ Next.js ë§Œì˜ í¸ì˜ì„±ì— ëŒ€í•´ì„œë§Œ ì ì–´ë³´ë„ë¡ í•˜ê² ë‹¤.

## í˜ì´ì§€ ë¼ìš°íŒ… ì§€ì›

ì´ ê¸°ëŠ¥ì€ [ìš°ë¦¬ë§µ í”„ë¡œì íŠ¸](https://github.com/mrbartrns/woorimap)ì—ì„œ ë„ˆë¬´ë‚˜ ì˜ ì‚¬ìš©í–ˆë˜ ê¸°ëŠ¥ì´ì, Next.jsì˜ ê°€ì¥ ëŒ€í‘œì ì¸ íŠ¹ì§•ì´ë¼ê³  ìƒê°í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.

React í”„ë¡œì íŠ¸ì—ì„œ ë¼ìš°íŒ… ì²˜ë¦¬ë¥¼ ìœ„í•´ `react-router-dom`ì„ ì´ìš©í–ˆë‹¤.

```tsx
import { Routes, Route } from 'react-router-dom';

const Router = () => {
  return (
    <Routes>
      <Route element={<NotFoundPage />} path="/404" />
      <Route
        path="/"
        element={<MainPage />}
      />
      <Route element={<PostDetailPage />} path="/posts/:id" />
  </Routes>
  )
}
```

ê·¸ë¦¬ê³  ë™ì  ë¼ìš°íŒ…ì„ ìœ„í•´ `PostDetailPage`ì—ì„œëŠ” `useParams`ë¥¼ í†µí•´ `id`ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

```tsx
import { useParams } from 'react-router-dom';

const PostDetailPage = () => {
  const { id } = useParams();

  // ...
}

export default PostDetailPage
```

ë°˜ë©´ì— Next.jsì—ì„œëŠ” ë‹¨ìˆœíˆ `pages` í´ë”ì— ì¼ì • ê·œì¹™ìœ¼ë¡œ íŒŒì¼ëª…ì„ ëª…ëª…í•˜ê¸°ë§Œ í•œë‹¤ë©´, urlì— ë”°ë¼ ìë™ìœ¼ë¡œ ë¼ìš°íŒ…ì„ ì²˜ë¦¬í•´ì¤€ë‹¤.

```
// pages í´ë” ë‚´ë¶€ì˜ íŒŒì¼ë“¤ì€ ì¼ì • ê·œì¹™ì— ë§ê²Œë” íŒŒì¼ëª…ì„ ì‘ì„±í•´ì•¼ í•œë‹¤.
pages
â”£ api
â”ƒ â”— hello.ts
â”£ feedback
â”ƒ â”— index.tsx
â”£ posts
â”ƒ â”£ index.tsx
â”ƒ â”— [id].tsx
â”£ index.tsx
â”£ _app.tsx
â”— _document.tsx
```

-   `pages` í´ë”ì˜ `index.tsx`ëŠ”, ì‚¬ìš©ìê°€ `/` ê²½ë¡œë¥¼ ìš”ì²­í–ˆì„ ë•Œ ë³´ì—¬ì¤„ ì»´í¬ë„ŒíŠ¸ê°€ ëœë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ `/posts` ë¥¼ ì‚¬ìš©ìê°€ ìš”ì²­í•˜ë©´, `posts/index.tsx` ë‚´ìš©ì´ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§€ê²Œ ëœë‹¤.
-   `[id].tsx`ê·œì¹™ì„ í†µí•´ dynamic routingì´ ê°€ëŠ¥í•˜ë‹¤. dynamic routingì€, `/posts/abc` ë“± ë™ì ìœ¼ë¡œ í•˜ìœ„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì•¼ í•˜ëŠ” ê²½ìš°ì— ìœ ìš©í•˜ë‹¤.
-   ë‹¤ìŒê³¼ ê°™ì´ ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ `useRouter`ë¥¼ í†µí•´ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤.

```tsx
// íŒŒì¼ ì´ë¦„ì´ [pid].tsx ë¼ë©´ router.query.pid ê°’ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.
import { useRouter } from 'next/router'

const Post = () => {
  const router = useRouter()
  const { pid } = router.query

  return <p>Post: {pid}</p>
}

export default Post
```

```tsx
// pages/api í´ë” íŒŒì¼ë“¤ì€ ì„œë²„ì‚¬ì´ë“œì—ì„œ ë™ì‘í•˜ì—¬ api endpointë¥¼ ì œê³µí•œë‹¤.
// verify.ts
import type { NextApiRequest, NextApiResponse } from 'next';
import type { CaptchaResponse } from '~models/Feedback';

const handler = async (req: NextApiRequest, res: NextApiResponse) => {
  try {
    const { captcha } = req.body;

    if (req.method !== 'POST') {
      return res
        .status(400)
        .json({ message: 'handler only allows POST method.' });
    }

    if (!captcha) {
      return res.status(400).json({
        message: 'Unproccesable request, please provide the required fields.',
      });
    }

    const captchaResponse = await fetch(
      '<https://www.google.com/recaptcha/api/siteverify>',
      {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: `secret=${process.env.RECAPTCHA_SECRET_KEY}&response=${captcha}`,
      }
    ).then((response) => response.json() as Promise<CaptchaResponse>);

    if (captchaResponse.success) {
      return res.status(200).json(captchaResponse);
    }

    return res
      .status(400)
      .json({ message: 'Unproccesable request, invalid captcha code.' });
  } catch (error) {
    console.error(error);
    return res.status(400).json({ message: 'bad request.' });
  }
};

export default handler;
```

í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” ê°„ë‹¨í•˜ê²Œ `api/verify` ê²½ë¡œë¥¼ ìš”ì²­í•˜ì—¬ ì›í•˜ëŠ” ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

## ë¯¸ë“¤ì›¨ì–´

ì•„ì§ ì‚¬ìš©í•´ ë³¸ ì ì€ ì—†ìœ¼ë‚˜, ì˜›ë‚ ì— Next.js í”„ë¡œì íŠ¸ë¥¼ í•˜ë©´ì„œ ì˜ ëª¨ë¥¼ ë•Œ [ìš°ë¦¬ë§µ í”„ë¡œì íŠ¸](https://github.com/mrbartrns/woorimap)ë‚˜ Reactì—ì„œ ì‚¬ìš©ì authorizationì„ ìœ„í•´ Next.js ëŠ” ê³ ì°¨í•¨ìˆ˜ë¥¼ , ReactëŠ” `react-router-dom`ì˜ `Route` ë¥¼ ë°”íƒ•ìœ¼ë¡œ `PrivateRotue` ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ì„œ ì²˜ë¦¬í–ˆë‹¤. (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ìš”ì²­ ì‹œ ì²˜ë¦¬)

```tsx
// in next.js
function withAuth<P>(Component: FunctionComponent<P>) {
  return function WithAuthComponent(props: P) {
    const mounted = useComponentDidMount();
    const user = useUser();
    const router = useRouter();

    useEffect(() => {
      if (!mounted) return;
      if (!user) {
        router.push('/auth/signin');
      }
    }, [mounted, router, user]);

    if (user) {
      return (
        <Component {...props} />
      );
    }
    return null;
  };
}

export default withAuth;
```

```tsx
// in Pure React
import { useLayoutEffect } from 'react';
import { useNavigate } from 'react-router-dom';

const Protected = ({ children }) => {
  const navigate = useNavigate();
  
  // useLayoutEffectì€ render í›„ layout, paint ê³¼ì • ì „ì— ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ë¯€ë¡œ ê¹œë¹¡ì„ ë°©ì§€ê°€ ê°€ëŠ¥í•˜ë‹¤.
  useLayoutEffect(() => {
    const value = window.localstorage.getItem<string>('token', '');

    if (!value) {
      navigate('/signin');
    }
  }, [navigate]);

  return children;
};

export default Protected;
```

## ê·¸ ì™¸ ë‹¤ì–‘í•œ ìµœì í™” ê¸°ìˆ ë“¤(í°íŠ¸ ìµœì í™”)

Next.jsëŠ” í°íŠ¸, css í”„ë¦¬ë¡œë“œ ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì„ Next.jsì˜ apië¥¼ ì´ìš©í•˜ì—¬ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

ì›¹ ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ë©´ í•„ìš”í•œ ìì›ì„ ì„œë²„ì— ìš”ì²­í•  ë•Œ ì„œë²„ëŠ” ìš”ì²­ ìˆœì„œì™€ ê´€ê³„ ì—†ì´ ì¤€ë¹„ê°€ ì™„ë£Œ ë˜ëŠ”ë°ë¡œ ì‘ë‹µí•˜ê²Œ ëœë‹¤.

ë¹ ë¥´ê²Œ ë¡œë”©ì‹œí‚¬ íŒŒì¼ì„ preloadì„¤ì •í•˜ê²Œ ë˜ë©´, ìš°ì„ ì ìœ¼ë¡œ í•´ë‹¹ íŒŒì¼ì„ ë¡œë“œí•  ìˆ˜ ìˆë‹¤.
ì¼ë°˜ì ìœ¼ë¡œ í°íŠ¸ íŒŒì¼ì˜ í¬ê¸°ë“¤ì´ í¬ê¸° ë•Œë¬¸ì— ë¡œë“œí•˜ëŠ” ë° ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ê³ , í˜ì´ì§€ê°€ ë¡œë“œëœ ë’¤ í°íŠ¸ê°€ ì ìš©ë˜ì–´ layout shiftê°€ ë°œìƒí•˜ê¸° ì‰¬ìš°ë©°, ì´ëŠ” ì‚¬ìš©ì ê²½í—˜ì— ë¶€ì •ì ì¸ ì˜í–¥ì„ ë¼ì¹  ìˆ˜ ìˆë‹¤.

next.jsì˜ í°íŠ¸ ìµœì í™” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´, ë¦¬ì†ŒìŠ¤ê°€ í° í°íŠ¸ íŒŒì¼ì„ í”„ë¦¬ë¡œë“œí•˜ì—¬ layout shiftë¥¼ ìµœì†Œí™”í•  ìˆ˜ ìˆë‹¤. êµ¬ê¸€ í°íŠ¸ ê°™ì€ ê²½ìš° ì´ë¯¸ apií™” ë˜ì–´ìˆìœ¼ë©°, ê°œë°œìê°€ ì›í•˜ëŠ” í°íŠ¸ë¥¼ localì— ì €ì¥í•˜ì—¬ ìµœì í™”ê°€ ê°€ëŠ¥í•˜ë‹¤.

```tsx
// font.ts
import localFont from '@next/font/local';

// font optimization
export const Pretendard = localFont({
  src: [
    {
      path: './Pretendard-Regular.woff',
      weight: '400',
    },
    {
      path: './Pretendard-Medium.woff',
      weight: '500',
    },
    {
      path: './Pretendard-Bold.woff',
      weight: '700',
    },
  ],
});

// _app.tsx
import { Pretendard } from './font.ts';

const MyApp = ({ Component, pageProps }: AppProps) => {
  return (
    <div className={Pretendard.className}>
      <Component {...pageProps} />
    </div>
  );
};

export default MyApp;
```

í°íŠ¸ ìµœì í™” ì ìš© í›„ ë¸Œë¼ìš°ì €ì—ì„œ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

![https://user-images.githubusercontent.com/56826914/227710196-c25d83fc-7ebd-4351-a00d-06f9344d6906.png](https://user-images.githubusercontent.com/56826914/227710196-c25d83fc-7ebd-4351-a00d-06f9344d6906.png)

# ë§ˆì¹˜ë©°

ì´ë²ˆ ë¸”ë¡œê·¸ë¥¼ ë§Œë“¤ë©´ì„œ ì—¬ëŸ¬ Next.jsê°€ ì œê³µí•˜ëŠ” í¸ì˜ì„±ì„ ì‚¬ìš©í•˜ë©´ì„œ ëŠê¼ˆë˜ ì ì„ ê°„ë‹¨í•˜ê²Œ ì ì–´ë³´ì•˜ë‹¤. ê·¸ë ‡ì§€ë§Œ ì•„ì§ ì‚¬ìš©í•˜ì§€ ëª»í–ˆë˜ í¸ë¦¬í•œ ê¸°ëŠ¥ë“¤ë„ ë§ë‹¤. ì˜ˆë¥¼ ë“¤ë©´ middleware ì²˜ë¦¬ ê°™ì€ ë¶€ë¶„ ë§ì´ë‹¤. ê³„ì† ë¸”ë¡œê·¸ë¥¼ ê³ ë„í™” í•˜ë©´ì„œ, ê¸°íšŒê°€ ìˆë‹¤ë©´ ì ê·¹ì ìœ¼ë¡œ ì‚¬ìš©í•´ ë³´ë ¤ê³  í•œë‹¤.

# ì¶œì²˜

[ì–´ì„œ ì™€, SSRì€ ì²˜ìŒì´ì§€? - ë„ì… í¸](https://d2.naver.com/helloworld/7804182)
[[Next.js] SSG, SSR ê°œë… ì •ë¦¬](https://narup.tistory.com/235)
[Next.jsì˜ ë Œë”ë§ ê³¼ì •(Hydrate) ì•Œì•„ë³´ê¸°](https://www.howdy-mj.me/next/hydrate)
[API Routes: Introduction | Next.js](https://nextjs.org/docs/api-routes/introduction)
[CORSëŠ” ì™œ ì´ë ‡ê²Œ ìš°ë¦¬ë¥¼ í˜ë“¤ê²Œ í•˜ëŠ”ê±¸ê¹Œ?](https://evan-moon.github.io/2020/05/21/about-cors/#cors%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%99%EC%9E%91%ED%95%98%EB%82%98%EC%9A%94)
[Advanced Features: Middleware | Next.js](https://nextjs.org/docs/advanced-features/middleware)
[Next.js - middleware ì‚¬ìš©í•˜ê¸° (ë¡œê·¸ì¸ ì—°ë™í•˜ê¸°)](https://junheedot.tistory.com/entry/Nextjs-middleware-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0)
[Preloadì˜ ê°œë…, ê·¸ë¦¬ê³  ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²•](https://helloinyong.tistory.com/319)